!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.jtmpl=e()}}(function(){var define,module,exports;return function e(n,t,o){function r(c,a){if(!t[c]){if(!n[c]){var l="function"==typeof require&&require;if(!a&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+c+"'")}var u=t[c]={exports:{}};n[c][0].call(u.exports,function(e){var t=n[c][1][e];return r(t?t:e)},u,u.exports,e,n,t,o)}return t[c].exports}for(var i="function"==typeof require&&require,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(e,n){function t(e){if(!(this instanceof t))return new t(e);e||(e={}),e.nodeType&&(e={el:e}),this.opts=e,this.el=e.el||document.body,"object"!=typeof this.el&&(this.el=document.querySelector(this.el))}n.exports=function(e){return new t(e)},t.prototype.add=function(e){var n=this.el;if(n){if(""===n.className)return n.className=e;var t=n.className.split(" ");return t.indexOf(e)>-1?t:(t.push(e),n.className=t.join(" "),t)}},t.prototype.remove=function(e){var n=this.el;if(n&&""!==n.className){var t=n.className.split(" "),o=t.indexOf(e);return o>-1&&t.splice(o,1),n.className=t.join(" "),t}},t.prototype.has=function(e){var n=this.el;if(n){var t=n.className.split(" ");return t.indexOf(e)>-1}}},{}],2:[function(e,n){"use strict";function t(e,n,o,r){function i(e,n){if(!e)throw n||"assertion failed"}function c(e,n){for(var t=0,o=Object.getOwnPropertyNames(n),r=o.length;r>t;t++)e[o[t]]=n[o[t]]}function a(){var e=arguments[0],n=["string","number"].indexOf(typeof arguments[1])>-1?arguments[1]:null,t="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;i(["change","update","insert","delete"].indexOf(e)>-1),i(["change"].indexOf(e)>-1&&null!==n||["insert","delete","update"].indexOf(e)>-1&&null===n),g[e][n]||(g[e][n]=[]),-1===g[e][n].indexOf(t)&&g[e][n].push(t)}function l(){var e,n=arguments[0],t="string"==typeof arguments[1]?arguments[1]:null,o="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;g[n][t]&&(o?(e=g[n][t].indexOf(o),e>-1&&g[n][t].splice(e,1)):g[n][t]=[])}function u(e,n,t){(g[e][["change"].indexOf(e)>-1?n:null]||[]).map(function(e){e.call(y,n,t)})}function s(e){"function"!=typeof N[e]&&N[e]!==p(e)&&u("change",e);for(var n=0,t=v[e]||[],o=t.length;o>n;n++)y.trigger("update",t[n]);y.parent&&y.parent.trigger("update",y.prop)}function d(e){return function(n,t){return v[n]||(v[n]=[]),-1===v[n].indexOf(e)&&v[n].push(e),m(n,t)}}function p(o,r){var i=e[o],c="function"==typeof i?N[o]=i.call(d(o),r):i;return c&&"object"==typeof c?"function"==typeof N[o]?N[o]:N[o]=t(i,n||y,y,o):c}function f(n,t){"function"==typeof e[n]?e[n].call(d(n),t):(e[n]=t,t&&"object"==typeof t&&delete N[n]),u("update",n)}function m(e,n){return(void 0===n||"function"==typeof n?p:f)(e,n)}function h(n,t){return function(){var o=[][n].apply(e,arguments);return this.len=this.values.length,t.apply(this,arguments),y.parent.trigger("update",y.prop),o}}var g={change:{},update:{},insert:{},delete:{}},v={},N={},y=function(){return m.apply(null,arguments)};return c(y,{values:e,parent:o||null,root:n||y,prop:r||null,on:a,off:l,trigger:u}),Array.isArray(e)&&c(y,{len:e.length,pop:h("pop",function(){u("delete",this.len,1)}),push:h("push",function(){u("insert",this.len-1,1)}),reverse:h("reverse",function(){N={},u("delete",0,this.len),u("insert",0,this.len)}),shift:h("shift",function(){N={},u("delete",0,1)}),unshift:h("unshift",function(){N={},u("insert",0,1)}),sort:h("sort",function(){N={},u("delete",0,this.len),u("insert",0,this.len)}),splice:h("splice",function(){N={},arguments[1]&&u("delete",arguments[0],arguments[1]),arguments.length>2&&u("insert",arguments[0],arguments.length-2)})}),a("update",s),y}"object"==typeof n&&(n.exports=t)},{}],3:[function(e,n){n.exports=function n(t,o,r){function i(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function c(e,n){return RegExp(i(e.delimiters[0])+"("+T.RE_ANYTHING+")"+i(e.delimiters[1]),n)}function a(n,t,o,r,i){var c,a,l=e("./rules"),u=l.length;for(n=n.slice(i.delimiters[0].length,-i.delimiters[1].length),c=0;u>c;c++)if(a=l[c](n,t,o,r,i))return a.index=c,a}function l(e,n){return e=e.replace(RegExp(i(n.delimiters[0]+"{")+T.RE_SRC_IDENTIFIER+i("}"+n.delimiters[1]),"g"),n.delimiters[0]+"&$1"+n.delimiters[1]),e=e.replace(c(n,"g"),function(n,t,o){var r=e.slice(0,o),i=!!r.match(RegExp("<"+T.RE_SRC_IDENTIFIER+"[^>]*?$")),c=!!r.match(/<!--\s*$/),a=0===t.indexOf("!");return i||c?a?"":n:"<!--"+n+"-->"})}function u(e,n,t){var o=n.match(RegExp(i(t.delimiters[0])+"\\/"+T.RE_SRC_IDENTIFIER+"?"+i(t.delimiters[1])));return o?""===e||void 0===o[1]||o[1]===e:!1}var s,d,p,f,m,h,g,v,N,y,E,_,x,R,I,b,T=e("./consts"),D=document.createDocumentFragment(),O=e("freak");for(r=r||e("./default-options"),o="function"==typeof o?o:O("object"==typeof o?o:{".":o}),t instanceof Node?y=t:(t=l(t,r),y=document.createElement("body"),y.innerHTML=t),s=0,d=y.childNodes,p=d.length;p>s;s++)switch(E=d[s],_=E.cloneNode(!1),D.appendChild(_),_.nodeType){case 1:for(_.__jtmpl__=o,f=0,m=_.attributes.length;m>f;f++)for(h=_.attributes[f],g=h.value,x=c(r,"g");R=x.exec(g);)if(I=a(R[0],_,h.name,o,r)){if(I.block){for(b=R[0],v=R.index,N=R.index+R[0].length;R&&!u(I.block,R[0],r);R=x.exec(g));if(!R)throw"Unclosed"+b;h.value=h.value.slice(0,v)+I.replace(h.value.slice(N,R.index))+h.value.slice(R.index+R[0].length)}void 0!==I.replace&&(h.value=I.replace),I.change&&(o.on("change",I.block||I.prop,I.change),I.change())}_.appendChild(n(E,o,r));break;case 8:if(u("",_.data,r))throw"jtmpl: Unexpected "+_.data;if((R=_.data.match(c(r)))&&(I=a(_.data,E,null,o,r))){if(I.replace instanceof Node&&_.parentNode.replaceChild(I.replace,_),I.block){for(b=document.createDocumentFragment(),s++;p>s&&!u(I.block,d[s].data||"",r);s++)b.appendChild(d[s].cloneNode(!0));if(s===p)throw"jtmpl: Unclosed "+_.data;_.parentNode.replaceChild(I.replace(b,_.parentNode),_)}I.prop&&I.change&&(o.on("change",I.prop,I.change),I.change())}}return D}},{"./consts":4,"./default-options":5,"./rules":8,freak:2}],4:[function(e,n){n.exports={RE_IDENTIFIER:/^[\w\.\-]+$/,RE_SRC_IDENTIFIER:"([\\w\\.\\-]+)",RE_PARTIAL:/>([\w\.\-]+)|'([^\']*)\'|"([^"]*)"/,RE_PIPE:/^[\w\.\-]+(?:\|[\w\.\-]+)?$/,RE_NODE_ID:/^#[\w\.\-]+$/,RE_ENDS_WITH_NODE_ID:/.+(#[\w\.\-]+)$/,RE_ANYTHING:"[\\s\\S]*?",RE_SPACE:"\\s*"}},{}],5:[function(e,n){n.exports={delimiters:["{{","}}"]}},{}],6:[function(_dereq_,module,exports){module.exports=function(target,src,model){function mixin(e,n){for(var t in n)0===t.indexOf("__")&&t.lastIndexOf("__")===t.length-2?void 0===e.values[t]&&(e.values[t]=n[t]):void 0===e(t)&&e(t,n[t])}function applyPlugins(){var e,n;for(e in jtmpl.plugins)plugin=jtmpl.plugins[e],n=model.values["__"+e+"__"],"function"==typeof plugin&&void 0!==n&&plugin.call(model,n)}function evalObject(body){var result,module={exports:{}};return body.match(/^\s*{[\S\s]*}\s*$/)?eval("result="+body):new Function("module","exports",body+";return module.exports;")(module,module.exports)}function loadModel(e,n,t){if(e)if(e.match(consts.RE_NODE_ID)){var o=t.querySelector(e);mixin(model,evalObject(o.innerHTML)),applyPlugins(),jtmpl(target,n,model)}else jtmpl("GET",e,function(t){var o=e.match(consts.RE_ENDS_WITH_NODE_ID),r=o&&(new DOMParser).parseFromString(t,"text/html").querySelector(o[1]);mixin(model,evalObject(o?r.innerHTML:t)),applyPlugins(),jtmpl(target,n,model)});else jtmpl(target,n,model)}function loadTemplate(){if(src.match(consts.RE_NODE_ID)){var e=document.querySelector(src);loadModel(e.getAttribute("data-model"),e.innerHTML,document)}else jtmpl("GET",src,function(e){var n,t=src.match(consts.RE_ENDS_WITH_NODE_ID);t?(n=document.implementation.createHTMLDocument(""),n.documentElement.innerHTML=e):n=document;var o=t&&n.querySelector(t[1]);loadModel(t?o.getAttribute("data-model"):"",t?o.innerHTML:e,n)})}var consts=_dereq_("./consts");model=model||{},"function"!=typeof model&&(model=jtmpl.freak(model)),loadTemplate()}},{"./consts":4}],7:[function(e,n){function t(){var n,r,i,c,a=[].slice.call(arguments);return["GET","POST"].indexOf(a[0])>-1?e("./xhr").apply(null,a):1===a.length&&"string"==typeof a[0]?document.querySelector(a[0]).__jtmpl__:void((a[0]instanceof Node||"string"==typeof a[0])&&(a[1]instanceof Node||a[1]instanceof DocumentFragment||"string"==typeof a[1])&&void 0!==a[2]&&(n=a[0]instanceof Node?a[0]:document.querySelector(a[0]),i=a[1].match(o.RE_NODE_ID)?document.querySelector(a[1]).innerHTML:a[1],c="function"==typeof a[2]?a[2]:t.freak("object"==typeof a[2]?a[2]:"string"==typeof a[2]&&a[2].match(o.RE_NODE_ID)?e("./loader")(document.querySelector(a[2]).innerHTML):{".":a[2]}),"SCRIPT"===n.nodeName&&(r=document.createElement("div"),r.id=n.id,n.parentNode.replaceChild(r,n),n=r),n.__jtmpl__=c,n.innerHTML="",n.appendChild(e("./compiler")(i,c,a[3]))))}var o=e("./consts");document.addEventListener("DOMContentLoaded",function(){for(var n=e("./loader"),t=document.querySelectorAll("[data-jtmpl]"),o=0,r=t.length;r>o;o++)n(t[o],t[o].getAttribute("data-jtmpl"))}),t.freak=e("freak"),t.plugins={init:function(e){"function"==typeof e&&e.call(this)}},n.exports=t},{"./compiler":3,"./consts":4,"./loader":6,"./xhr":16,freak:2}],8:[function(e,n){n.exports=[e("./rules/value-var"),e("./rules/class-section"),e("./rules/section"),e("./rules/inverted-section"),e("./rules/partial"),e("./rules/unescaped-var"),e("./rules/var")]},{"./rules/class-section":9,"./rules/inverted-section":10,"./rules/partial":11,"./rules/section":12,"./rules/unescaped-var":13,"./rules/value-var":14,"./rules/var":15}],9:[function(e,n){n.exports=function(n,t,o,r){var i,c=n.match(new RegExp("#"+e("../consts").RE_SRC_IDENTIFIER)),a=c&&c[1];return"class"===o&&c?{block:a,replace:function(e){return i=e,""},change:function(){var n=r(a);e("element-class")(t)[!!n&&"add"||"remove"](i)}}:void 0}},{"../consts":4,"element-class":1}],10:[function(e,n){n.exports=function(n,t,o,r){function i(){for(var e,n,t="."===u?r:r(u);p;)d.parentNode.removeChild(d.previousSibling),p--;"function"==typeof t&&void 0!==t.len?(t.on("insert",i),t.on("delete",i),n=document.createDocumentFragment(),0===t.len&&n.appendChild(a(c,t(e))),p=n.childNodes.length,d.parentNode.insertBefore(n,d)):t||(n=a(c,r),p=n.childNodes.length,d.parentNode.insertBefore(n,d))}var c,a=e("../compiler"),l=n.match(new RegExp("^\\^"+e("../consts").RE_SRC_IDENTIFIER)),u=l&&l[1],s=document.createDocumentFragment(),d=document.createComment(""),p=0;return l?{prop:u,block:u,replace:function(e){return s.appendChild(d),c=e,d},change:i}:void 0}},{"../compiler":3,"../consts":4}],11:[function(e,n){n.exports=function(n,t,o,r){var i=e("../consts"),c=n.match(i.RE_PARTIAL),a=document.createComment(""),l=c&&function(){e("../loader")(a.parentNode,c[1]?r(c[1]):c[2]||c[3],r)};return c?(c[1]&&r.on("change",c[1],l),setTimeout(l,0),{replace:a}):void 0}},{"../consts":4,"../loader":6}],12:[function(e,n){n.exports=function(n,t,o,r){function i(e){return function(){var n=m.parentNode,t=[].indexOf.call(n.childNodes,m),o=t-h+e*u.childNodes.length;n.replaceChild(s(u,r(p)(e)),n.childNodes[o])}}function c(e,n){var t,o,i=m.parentNode,c=[].indexOf.call(i.childNodes,m),a=c-h+e*u.childNodes.length,l=n*u.childNodes.length;for(t=0,o=document.createDocumentFragment();n>t;t++)o.appendChild(s(u,r(p)(e+t)));i.insertBefore(o,i.childNodes[a]),h+=l}function a(e,n){var t=m.parentNode,o=[].indexOf.call(t.childNodes,m),r=o-h+e*u.childNodes.length,i=n*u.childNodes.length;for(h-=i;i--;)t.removeChild(t.childNodes[r])}function l(){for(var e,n,t,o="."===p?r:r(p);h;)m.parentNode.removeChild(m.previousSibling),h--;if("function"==typeof o&&void 0!==o.len){for(o.on("insert",c),o.on("delete",a),t=document.createDocumentFragment(),e=0,n=o.len;n>e;e++)o.on("change",e,i(e)),t.appendChild(s(u,o(e)));h=t.childNodes.length,m.parentNode.insertBefore(t,m)}else"function"==typeof o&&void 0===o.len?(t=s(u,o),h=t.childNodes.length,m.parentNode.insertBefore(t,m)):o&&(t=s(u,r),h=t.childNodes.length,m.parentNode.insertBefore(t,m))}var u,s=e("../compiler"),d=n.match(new RegExp("^#"+e("../consts").RE_SRC_IDENTIFIER)),p=d&&d[1],f=document.createDocumentFragment(),m=document.createComment(""),h=0;return d?{prop:p,block:p,replace:function(e){return f.appendChild(m),u=e,m},change:l}:void 0}},{"../compiler":3,"../consts":4}],13:[function(e,n){n.exports=function(n,t,o,r){var i=n.match(new RegExp("^&"+e("../consts").RE_SRC_IDENTIFIER)),c=i&&i[1],a=document.createComment(""),l=0;return i&&!o?{prop:c,replace:a,change:function(){for(var e,n=document.createDocumentFragment(),t=document.createElement("body");l;)a.parentNode.removeChild(a.previousSibling),l--;for(t.innerHTML=r(c),l=t.childNodes.length,e=0;l>e;e++)n.appendChild(t.childNodes[0]);a.parentNode.insertBefore(n,a)}}:void 0}},{"../consts":4}],14:[function(e,n){n.exports=function(n,t,o,r){function i(){var e=r(a);t[o]!==e&&(t[o]=e)}var c=n.match(e("../consts").RE_IDENTIFIER),a=c&&c[0];if(c&&["value","checked","selected"].indexOf(o)>-1){"OPTION"===t.nodeName&&setTimeout(function(){t&&t.parentNode&&!t.parentNode.__value_var_change&&(t.parentNode.__value_var_change=!0,t.parentNode.addEventListener("change",function(){r(a)!==t.selected&&r(a,t.selected)}))},0),"radio"===t.type&&t.name&&t.addEventListener("change",function(){if(t[o])for(var e=0,n=document.querySelectorAll("input[type=radio][name="+t.name+"]"),i=n.length;i>e;e++)n[e]!==t&&n[e].dispatchEvent(new Event("change"));r(a,t[o])});var l=["text","password"].indexOf(t.type)>-1?"input":"change";return t.addEventListener(l,function(){r(a,t[o])}),{prop:a,replace:"",change:i}}}},{"../consts":4}],15:[function(e,n){n.exports=function(n,t,o,r){var i,c;return n.match(e("../consts").RE_IDENTIFIER)?(o?c=function(){var e=r(n);return e?t.setAttribute(o,e):t.removeAttribute(o)}:(i=document.createTextNode(""),c=function(){i.data=r(n)||""}),{prop:n,replace:i,change:c}):void 0}},{"../consts":4}],16:[function(e,n){n.exports=function(){var e,n,t,o,r,i=[].slice.call(arguments),c=new XMLHttpRequest,a=i.reduce(function(e,n){return"function"==typeof n?n:e},null),l=i[i.length-1];for("object"!=typeof l&&(l={}),e=0,o=Object.getOwnPropertyNames(l),n=o.length;n>e;e++)t=o[e],c[t]=l[t];r="string"==typeof i[2]?i[2]:"object"==typeof i[2]?Object.keys(i[2]).map(function(e){return e+"="+encodeURIComponent(i[2][e])}).join("&"):"",c.onload=function(e){var n;if(a){try{n=JSON.parse(this.responseText)}catch(e){n=this.responseText}a.call(this,n,e)}},c.open(i[0],i[1],void 0!==l.async?l.async:!0,l.user,l.password),c.send(r)}},{}]},{},[7])(7)});