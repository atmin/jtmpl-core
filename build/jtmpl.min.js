!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.jtmpl=e()}}(function(){var define,module,exports;return function e(t,n,o){function r(c,i){if(!n[c]){if(!t[c]){var a="function"==typeof require&&require;if(!i&&a)return a(c,!0);if(l)return l(c,!0);throw new Error("Cannot find module '"+c+"'")}var s=n[c]={exports:{}};t[c][0].call(s.exports,function(e){var n=t[c][1][e];return r(n?n:e)},s,s.exports,e,t,n,o)}return n[c].exports}for(var l="function"==typeof require&&require,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(e,t){function n(e){if(!(this instanceof n))return new n(e);e||(e={}),e.nodeType&&(e={el:e}),this.opts=e,this.el=e.el||document.body,"object"!=typeof this.el&&(this.el=document.querySelector(this.el))}t.exports=function(e){return new n(e)},n.prototype.add=function(e){var t=this.el;if(t){if(""===t.className)return t.className=e;var n=t.className.split(" ");return n.indexOf(e)>-1?n:(n.push(e),t.className=n.join(" "),n)}},n.prototype.remove=function(e){var t=this.el;if(t&&""!==t.className){var n=t.className.split(" "),o=n.indexOf(e);return o>-1&&n.splice(o,1),t.className=n.join(" "),n}},n.prototype.has=function(e){var t=this.el;if(t){var n=t.className.split(" ");return n.indexOf(e)>-1}}},{}],2:[function(e,t){"use strict";function n(e,t,o,r){function l(e,t){if(!e)throw t||"assertion failed"}function c(e,t){for(var n=0,o=Object.getOwnPropertyNames(t),r=o.length;r>n;n++)e[o[n]]=t[o[n]]}function i(){var e=arguments[0],t=["string","number"].indexOf(typeof arguments[1])>-1?arguments[1]:null,n="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;l(["change","insert","delete"].indexOf(e)>-1),l("change"===e&&null!==t||("insert"===e||"delete"===e)&&!t),d[e][t]||(d[e][t]=[]),-1===d[e][t].indexOf(n)&&d[e][t].push(n)}function a(){var e,t=arguments[0],n="string"==typeof arguments[1]?arguments[1]:null,o="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;d[t][n]&&(o?(e=d[t][n].indexOf(o),e>-1&&d[t][n].splice(e,1)):d[t][n]=[])}function s(e,t,n){(d[e]["change"===e?t:null]||[]).map(function(e){e.call(h,t,n)})}function u(o,r,l){function c(e,t,n){return f[e]||(f[e]=[]),-1===f[e].indexOf(o)&&f[e].push(o),u(e,t,n)}var i,a,d,m,g;if(!(void 0!==r&&"function"!=typeof r||l))return g=e[o],m="function"==typeof g?g.call(c,r):g,"object"==typeof m?"function"==typeof p[o]?p[o]:p[o]=n(g,t||h,h,o):m;for(l||("function"==typeof e[o]?e[o].call(c,r):e[o]=r),i=0,d=f[o]||[],a=d.length;a>i;i++)u(d[i],r,!0);s("change",o)}var d={change:{},insert:{},delete:{}},f={},p={},m={len:e.length,pop:function(){var t=[].pop.apply(e);return this.len=this.values.length,s("delete",this.len,1),t},push:function(){var t=[].push.apply(e,arguments);return this.len=this.values.length,s("insert",this.len-1,1),t},reverse:function(){var t=[].reverse.apply(e);return this.len=e.length,p={},s("delete",0,this.len),s("insert",0,this.len),t},shift:function(){var t=[].shift.apply(e);return this.len=e.length,p={},s("delete",0,1),t},unshift:function(){var t=[].unshift.apply(e,arguments);return this.len=e.length,p={},s("insert",0,1),t},sort:function(){var t=[].sort.apply(e,arguments);return p={},s("delete",0,this.len),s("insert",0,this.len),t},splice:function(){var t=[].splice.apply(e,arguments);return this.len=e.length,p={},arguments[1]&&s("delete",arguments[0],arguments[1]),arguments.length>2&&s("insert",arguments[0],arguments.length-2),t}},h=function(){return u.apply(null,arguments)},g={values:e,parent:o||null,root:t||h,prop:r||null,on:i,off:a};return c(h,g),Array.isArray(e)&&c(h,m),h}"object"==typeof t&&(t.exports=n)},{}],3:[function(e,t){t.exports=function e(t,n){return null==t||null==n?t:(Object.keys(n).forEach(function(o){t[o]="[object Object]"==Object.prototype.toString.call(n[o])?"[object Object]"!=Object.prototype.toString.call(t[o])?n[o]:e(t[o],n[o]):n[o]}),t)}},{}],4:[function(e,t){t.exports=function t(n,o,r){function l(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function c(e,t){return RegExp(l(e.delimiters[0])+"("+I.RE_ANYTHING+")"+l(e.delimiters[1]),t)}function i(t,n,o,r,l){var c,i,a=e("./rules"),s=a.length;for(t=t.slice(l.delimiters[0].length,-l.delimiters[1].length),c=0;s>c;c++)if(i=a[c](t,n,o,r,l))return i.index=c,i}function a(e,t){return e.replace(c(t,"g"),function(t,n,o){var r=e.slice(0,o),l=!!r.match(RegExp("<"+I.RE_SRC_IDENTIFIER+"[^>]*?$")),c=!!r.match(/<!--\s*$/);return l||c?t:"<!--"+t+"-->"})}function s(e,t,n){var o=t.match(RegExp(l(n.delimiters[0])+"\\/"+I.RE_SRC_IDENTIFIER+"?"+l(n.delimiters[1])));return o?""===e||void 0===o[1]||o[1]===e:!1}var u,d,f,p,m,h,g,v,y,N,x,E,_,b,R,O,I=e("./consts"),j=document.createDocumentFragment(),T=e("freak");for(r=r||e("./default-options"),o="function"==typeof o?o:T("object"==typeof o?o:{".":o}),n instanceof Node?N=n:(n=a(n,r),N=document.createElement("body"),N.innerHTML=n),u=0,d=N.childNodes,f=d.length;f>u;u++)switch(x=d[u],E=x.cloneNode(!1),j.appendChild(E),E.nodeType){case 1:for(p=0,m=E.attributes.length;m>p;p++)for(h=E.attributes[p],g=h.value,_=c(r,"g");b=_.exec(g);)if(R=i(b[0],E,h.name,o,r),R&&R.block){for(O=b[0],v=b.index,y=b.index+b[0].length;b&&!s(R.block,b[0],r);b=_.exec(g));if(!b)throw"Unclosed"+O;h.value=h.value.slice(0,v)+R.replace(h.value.slice(y,b.index))+h.value.slice(b.index+b[0].length)}E.appendChild(t(x,o,r));break;case 8:if(s("",E.data,r))throw"jtmpl: Unexpected "+E.data;if((b=E.data.match(c(r)))&&(R=i(E.data,b[1],null,o,r),R&&(R.replace instanceof Node&&E.parentNode.replaceChild(R.replace,E),R.block))){for(O=document.createDocumentFragment(),u++;f>u&&!s(R.block,d[u].data||"",r);u++)O.appendChild(d[u].cloneNode(!0));if(u===f)throw"jtmpl: Unclosed "+E.data;E.parentNode.replaceChild(R.replace(O,E.parentNode),E)}}return j}},{"./consts":5,"./default-options":6,"./rules":9,freak:2}],5:[function(e,t){t.exports={RE_IDENTIFIER:/^[\w\.\-]+$/,RE_SRC_IDENTIFIER:"([\\w\\.\\-]+)",RE_PARTIAL:/>([\w\.\-]+)|'([^\']*)\'|"([^"]*)"/,RE_PIPE:/^[\w\.\-]+(?:\|[\w\.\-]+)?$/,RE_NODE_ID:/^#[\w\.\-]+$/,RE_ENDS_WITH_NODE_ID:/.+(#[\w\.\-]+)$/,RE_ANYTHING:"[\\s\\S]*?",RE_SPACE:"\\s*"}},{}],6:[function(e,t){t.exports={delimiters:["{{","}}"]}},{}],7:[function(_dereq_,module,exports){module.exports=function(target,src,model){function evalObject(body){var result,module={exports:{}};return body.match(/^\s*{[\S\s]*}\s*$/)?eval("result="+body):new Function("module","exports",body+";return module.exports;")(module,module.exports)}function loadModel(e,t,n){if(e)if(e.match(consts.RE_NODE_ID)){var o=n.querySelector(e),r=extend(evalObject(o.innerHTML),model.values);jtmpl(target,t,r),model.prop&&(model.parent.values[model.prop]=r)}else jtmpl("GET",e,function(n){var o=e.match(consts.RE_ENDS_WITH_NODE_ID),r=o&&(new DOMParser).parseFromString(n,"text/html").querySelector(o[1]),l=extend(o?evalObject(r.innerHTML):{},model.values);jtmpl(target,t,l),model.prop&&(model.parent.values[model.prop]=l)});else jtmpl(target,t,model)}function loadTemplate(){if(src.match(consts.RE_NODE_ID)){var e=document.querySelector(src);loadModel(e.getAttribute("data-model"),e.innerHTML,document)}else jtmpl("GET",src,function(e){var t=src.match(consts.RE_ENDS_WITH_NODE_ID),n=t?(new DOMParser).parseFromString(e,"text/html"):document,o=t&&n.querySelector(t[1]);loadModel(t?o.getAttribute("data-model"):"",t?o.innerHTML:e,n)})}var consts=_dereq_("./consts"),extend=_dereq_("object-extend");model=model||{},"function"!=typeof model&&(model=jtmpl.freak(model)),loadTemplate()}},{"./consts":5,"object-extend":3}],8:[function(e,t){function n(){var t,r,l,c,i=[].slice.call(arguments);return["GET","POST"].indexOf(i[0])>-1?e("./xhr").apply(null,i):1===i.length&&"string"==typeof i[0]?document.querySelector(i[0]).__jtmpl__:"string"==typeof i[0]&&["object","function"].indexOf(typeof i[1])>-1&&["object","undefined"].indexOf(typeof i[2])>-1?e("./compiler").apply(null,i):void((i[0]instanceof Node||"string"==typeof i[0])&&(i[1]instanceof Node||i[1]instanceof DocumentFragment||"string"==typeof i[1])&&void 0!==i[2]&&(t=i[0]instanceof Node?i[0]:document.querySelector(i[0]),l=i[1].match(o.RE_NODE_ID)?document.querySelector(i[1]).innerHTML:i[1],c="function"==typeof i[2]?i[2]:n.freak("object"==typeof i[2]?i[2]:"string"==typeof i[2]&&i[2].match(o.RE_NODE_ID)?e("./loader")(document.querySelector(i[2]).innerHTML):{".":i[2]}),"SCRIPT"===t.nodeName&&(r=document.createElement("div"),r.id=t.id,t.parentNode.replaceChild(r,t),t=r),t.__jtmpl__=c,t.innerHTML="",t.appendChild(e("./compiler")(l,c,i[3]))))}var o=e("./consts");document.addEventListener("DOMContentLoaded",function(){for(var t=e("./loader"),n=document.querySelectorAll("[data-jtmpl]"),o=0,r=n.length;r>o;o++)t(n[o],n[o].getAttribute("data-jtmpl"))}),n.freak=e("freak"),t.exports=n},{"./compiler":4,"./consts":5,"./loader":7,"./xhr":15,freak:2}],9:[function(e,t){t.exports=[e("./rules/value-var"),e("./rules/class-block"),e("./rules/block"),e("./rules/partial"),e("./rules/var")]},{"./rules/block":10,"./rules/class-block":11,"./rules/partial":12,"./rules/value-var":13,"./rules/var":14}],10:[function(e,t){t.exports=function(t,n,o,r){function l(e){return function(){var t=m.parentNode,n=[].indexOf.call(t.childNodes,m),o=n-h+e*s.childNodes.length;t.replaceChild(u(s,r(f)(e)),t.childNodes[o])}}function c(e,t){var n,o,l=m.parentNode,c=[].indexOf.call(l.childNodes,m),i=c-h+e*s.childNodes.length,a=t*s.childNodes.length;for(n=0,o=document.createDocumentFragment();t>n;n++)o.appendChild(u(s,r(f)(e+n)));l.insertBefore(o,l.childNodes[i]),h+=a}function i(e,t){var n=m.parentNode,o=[].indexOf.call(n.childNodes,m),r=o-h+e*s.childNodes.length,l=t*s.childNodes.length;for(h-=l;l--;)n.removeChild(n.childNodes[r])}function a(){for(var e,t,n,o="."===f?r:r(f);h;)m.parentNode.removeChild(m.previousSibling),h--;if("function"==typeof o&&o.len){for(o.on("insert",c),o.on("delete",i),n=document.createDocumentFragment(),e=0,t=o.len;t>e;e++)o.on("change",e,l(e)),n.appendChild(u(s,o(e)));h=n.childNodes.length,m.parentNode.insertBefore(n,m)}else"function"!=typeof o||o.len?o&&(n=u(s,r),h=n.childNodes.length,m.parentNode.insertBefore(n,m)):(n=u(s,o),h=n.childNodes.length,m.parentNode.insertBefore(n,m))}var s,u=e("../compiler"),d=t.match(new RegExp("^#"+e("../consts").RE_SRC_IDENTIFIER)),f=d&&d[1],p=document.createDocumentFragment(),m=document.createComment(""),h=0;return d?{block:f,replace:function(e){return p.appendChild(m),s=e,r.on("change",f,a),setTimeout(a,0),m}}:void 0}},{"../compiler":4,"../consts":5}],11:[function(e,t){t.exports=function(t,n,o,r){function l(){var t=r(a);e("element-class")(n)[!!t&&"add"||"remove"](c)}var c,i=t.match(new RegExp("#"+e("../consts").RE_SRC_IDENTIFIER)),a=i&&i[1];return"class"===o&&i?(r.on("change",a,l),setTimeout(l,0),{block:a,replace:function(e){return c=e,""}}):void 0}},{"../consts":5,"element-class":1}],12:[function(e,t){t.exports=function(t,n,o,r){var l=e("../consts"),c=t.match(l.RE_PARTIAL),i=document.createComment(""),a=c&&function(){e("../loader")(i.parentNode,c[1]?r(c[1]):c[2]||c[3],r)};return c?(c[1]&&r.on("change",c[1],a),setTimeout(a,0),{replace:i}):void 0}},{"../consts":5,"../loader":7}],13:[function(e,t){t.exports=function(t,n,o,r){function l(){var e=r(i);n[o]!==e&&(n[o]=e)}var c=t.match(e("../consts").RE_IDENTIFIER),i=c&&c[0];if(c&&["value","checked","selected"].indexOf(o)>-1){r.on("change",i,l),l(),"OPTION"===n.nodeName&&setTimeout(function(){n.parentNode.addEventListener("change",function(){r(i)!==n.selected&&r(i,n.selected)})},0),"radio"===n.type&&n.name&&n.addEventListener("change",function(){if(n[o])for(var e=0,t=document.querySelectorAll("input[type=radio][name="+n.name+"]"),l=t.length;l>e;e++)t[e]!==n&&t[e].dispatchEvent(new Event("change"));r(i,n[o])});var a=["text","password"].indexOf(n.type)>-1?"input":"change";return n.addEventListener(a,function(){r(i,n[o])}),{replace:""}}}},{"../consts":5}],14:[function(e,t){t.exports=function(t,n,o,r){var l;return t.match(e("../consts").RE_IDENTIFIER)?(o?r.on("change",t,function(){var e=r(t);return e?n.setAttribute(o,e):n.removeAttribute(o)}):(l=document.createTextNode(""),r.on("change",t,function(){l.data=r(t)||""})),r(t,r(t)),{replace:l}):void 0}},{"../consts":5}],15:[function(e,t){t.exports=function(){var e,t,n,o,r,l=[].slice.call(arguments),c=new XMLHttpRequest,i=l.reduce(function(e,t){return"function"==typeof t?t:e},null),a=l[l.length-1];for("object"!=typeof a&&(a={}),e=0,o=Object.getOwnPropertyNames(a),t=o.length;t>e;e++)n=o[e],c[n]=a[n];r="string"==typeof l[2]?l[2]:"object"==typeof l[2]?Object.keys(l[2]).map(function(e){return e+"="+encodeURIComponent(l[2][e])}).join("&"):"",c.onload=function(e){var t;if(i){try{t=JSON.parse(this.responseText)}catch(e){t=this.responseText}i.call(this,t,e)}},c.open(l[0],l[1],void 0!==a.async?a.async:!0,a.user,a.password),c.send(r)}},{}]},{},[8])(8)});