!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.jtmpl=e()}}(function(){var define,module,exports;return function e(n,t,o){function r(c,l){if(!t[c]){if(!n[c]){var a="function"==typeof require&&require;if(!l&&a)return a(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+c+"'")}var u=t[c]={exports:{}};n[c][0].call(u.exports,function(e){var t=n[c][1][e];return r(t?t:e)},u,u.exports,e,n,t,o)}return t[c].exports}for(var i="function"==typeof require&&require,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(e,n){function t(e){if(!(this instanceof t))return new t(e);e||(e={}),e.nodeType&&(e={el:e}),this.opts=e,this.el=e.el||document.body,"object"!=typeof this.el&&(this.el=document.querySelector(this.el))}n.exports=function(e){return new t(e)},t.prototype.add=function(e){var n=this.el;if(n){if(""===n.className)return n.className=e;var t=n.className.split(" ");return t.indexOf(e)>-1?t:(t.push(e),n.className=t.join(" "),t)}},t.prototype.remove=function(e){var n=this.el;if(n&&""!==n.className){var t=n.className.split(" "),o=t.indexOf(e);return o>-1&&t.splice(o,1),n.className=t.join(" "),t}},t.prototype.has=function(e){var n=this.el;if(n){var t=n.className.split(" ");return t.indexOf(e)>-1}}},{}],2:[function(e,n){"use strict";function t(e,n,o){function r(e,n){if(!e)throw n||"assertion failed"}function i(e,n){for(var t=0,o=Object.getOwnPropertyNames(n),r=o.length;r>t;t++)e[o[t]]=n[o[t]]}function c(){var e=arguments[0],n=["string","number"].indexOf(typeof arguments[1])>-1?arguments[1]:null,t="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;r(["change","insert","delete"].indexOf(e)>-1),r("change"===e&&null!==n||("insert"===e||"delete"===e)&&!n),s[e][n]||(s[e][n]=[]),-1===s[e][n].indexOf(t)&&s[e][n].push(t)}function l(){var e,n=arguments[0],t="string"==typeof arguments[1]?arguments[1]:null,o="function"==typeof arguments[1]?arguments[1]:"function"==typeof arguments[2]?arguments[2]:null;s[n][t]&&(o?(e=s[n][t].indexOf(o),e>-1&&s[n][t].splice(e,1)):s[n][t]=[])}function a(e,n,t){(s[e]["change"===e?n:null]||[]).map(function(e){e.call(m,n,t)})}function u(o,r,i){function c(e,n,t){return d[e]||(d[e]=[]),-1===d[e].indexOf(o)&&d[e].push(o),u(e,n,t)}var l,s,p,h,g;if(!(void 0!==r&&"function"!=typeof r||i))return g=e[o],h="function"==typeof g?g.call(c,r):g,"object"==typeof h?"function"==typeof f[o]?f[o]:f[o]=t(g,n||m,m):h;for(i||("function"==typeof e[o]?e[o].call(c,r):e[o]=r),l=0,p=d[o]||[],s=p.length;s>l;l++)u(p[l],r,!0);a("change",o)}var s={change:{},insert:{},delete:{}},d={},f={},p={len:e.length,pop:function(){var n=[].pop.apply(e);return this.len=this.values.length,a("delete",this.len,1),n},push:function(){var n=[].push.apply(e,arguments);return this.len=this.values.length,a("insert",this.len-1,1),n},reverse:function(){var n=[].reverse.apply(e);return this.len=e.length,a("delete",0,this.len),a("insert",0,this.len),n},shift:function(){var n=[].shift.apply(e);return this.len=e.length,a("delete",0,1),n},unshift:function(){var n=[].unshift.apply(e,arguments);return this.len=e.length,a("insert",0,1),n},sort:function(){var n=[].sort.apply(e,arguments);return a("delete",0,this.len),a("insert",0,this.len),n},splice:function(){var n=[].splice.apply(e,arguments);return this.len=e.length,arguments[1]&&a("delete",arguments[0],arguments[1]),arguments.length>2&&a("insert",arguments[0],arguments.length-2),n}},m=function(){return u.apply(null,arguments)},h={values:e,parent:o||null,root:n||m,on:c,off:l};return i(m,h),Array.isArray(e)&&i(m,p),m}"object"==typeof n&&(n.exports=t)},{}],3:[function(e,n){n.exports=function n(t,o,r){function i(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function c(e,n){return RegExp(i(e.delimiters[0])+"("+T.RE_ANYTHING+")"+i(e.delimiters[1]),n)}function l(n,t,o,r,i){var c,l,a=e("./rules"),u=a.length;for(n=n.slice(i.delimiters[0].length,-i.delimiters[1].length),c=0;u>c;c++)if(l=a[c](n,t,o,r,i))return l.index=c,l}function a(e,n){return e.replace(c(n,"g"),function(n,t,o){var r=e.slice(0,o),i=!!r.match(RegExp("<"+T.RE_SRC_IDENTIFIER+"[^>]*?$")),c=!!r.match(/<!--\s*$/);return i||c?n:"<!--"+n+"-->"})}function u(e,n,t){var o=n.match(RegExp(i(t.delimiters[0])+"\\/"+T.RE_SRC_IDENTIFIER+"?"+i(t.delimiters[1])));return o?""===e||void 0===o[1]||o[1]===e:!1}var s,d,f,p,m,h,g,v,y,N,x,E,b,R,I,_,T=e("./consts"),O=document.createDocumentFragment(),w=e("freak");for(r=r||e("./default-options"),o="function"==typeof o?o:w("object"==typeof o?o:{".":o}),t instanceof Node?N=t:(t=a(t,r),N=document.createElement("body"),N.innerHTML=t),s=0,d=N.childNodes,f=d.length;f>s;s++)switch(x=d[s],E=x.cloneNode(!1),O.appendChild(E),E.nodeType){case 1:for(p=0,m=E.attributes.length;m>p;p++)for(h=E.attributes[p],g=h.value,b=c(r,"g");R=b.exec(g);)if(I=l(R[0],E,h.name,o,r),I&&I.block){for(_=R[0],v=R.index,y=R.index+R[0].length;R&&!u(I.block,R[0],r);R=b.exec(g));if(!R)throw"Unclosed"+_;h.value=h.value.slice(0,v)+I.replace(h.value.slice(y,R.index))+h.value.slice(R.index+R[0].length)}E.appendChild(n(x,o,r));break;case 8:if(u("",E.data,r))throw"jtmpl: Unexpected "+E.data;if((R=E.data.match(c(r)))&&(I=l(E.data,R[1],null,o,r),I&&(I.replace instanceof Node&&E.parentNode.replaceChild(I.replace,E),I.block))){for(_=document.createDocumentFragment(),s++;f>s&&!u(I.block,d[s].data||"",r);s++)_.appendChild(d[s].cloneNode(!0));if(s===f)throw"jtmpl: Unclosed "+E.data;E.parentNode.replaceChild(I.replace(_,E.parentNode),E)}}return O}},{"./consts":4,"./default-options":5,"./rules":8,freak:2}],4:[function(e,n){n.exports={RE_IDENTIFIER:/^[\w\.\-]+$/,RE_SRC_IDENTIFIER:"([\\w\\.\\-]+)",RE_PARTIAL:/>([\w\.\-]+)|'([^\']*)\'|"([^"]*)"/,RE_PIPE:/^[\w\.\-]+(?:\|[\w\.\-]+)?$/,RE_NODE_ID:/^#[\w\.\-]+$/,RE_ANYTHING:"[\\s\\S]*?",RE_SPACE:"\\s*"}},{}],5:[function(e,n){n.exports={delimiters:["{{","}}"]}},{}],6:[function(_dereq_,module,exports){module.exports=function(body){var result,module={exports:{}};return body.match(/^\s*{[\S\s]*}\s*$/)?eval("result="+body):new Function("module","exports",body+";return module.exports;")(module,module.exports)}},{}],7:[function(e,n){function t(){var n,o,r,i,c=[].slice.call(arguments),l=e("./consts");return["GET","POST"].indexOf(c[0])>-1?e("./xhr").apply(null,c):1===c.length&&"string"==typeof c[0]?document.querySelector(c[0]).__jtmpl__:"string"==typeof c[0]&&["object","function"].indexOf(typeof c[1])>-1&&["object","undefined"].indexOf(typeof c[2])>-1?e("./compiler").apply(null,c):void((c[0]instanceof Node||"string"==typeof c[0])&&(c[1]instanceof Node||c[1]instanceof DocumentFragment||"string"==typeof c[1])&&void 0!==c[2]&&(n=c[0]instanceof Node?c[0]:document.querySelector(c[0]),r=c[1].match(l.RE_NODE_ID)?document.querySelector(c[1]).innerHTML:c[1],i="function"==typeof c[2]?c[2]:t.freak("object"==typeof c[2]?c[2]:"string"==typeof c[2]&&c[2].match(l.RE_NODE_ID)?e("./eval-object")(document.querySelector(c[2]).innerHTML):{".":c[2]}),"SCRIPT"===n.nodeName&&(o=document.createElement("div"),o.id=n.id,n.parentNode.replaceChild(o,n),n=o),n.__jtmpl__=i,n.innerHTML="",n.appendChild(e("./compiler")(r,i,c[3]))))}document.addEventListener("DOMContentLoaded",function(){for(var n,o,r=document.querySelectorAll("[data-jtmpl]"),i=0,c=r.length;c>i;i++)n=r[i],o=document.querySelector(n.getAttribute("data-jtmpl")),t(n,o.innerHTML,e("./eval-object")(document.querySelector(o.getAttribute("data-model")).innerHTML))}),t.freak=e("freak"),n.exports=t},{"./compiler":3,"./consts":4,"./eval-object":6,"./xhr":14,freak:2}],8:[function(e,n){n.exports=[e("./rules/value-var"),e("./rules/class-block"),e("./rules/block"),e("./rules/partial"),e("./rules/var")]},{"./rules/block":9,"./rules/class-block":10,"./rules/partial":11,"./rules/value-var":12,"./rules/var":13}],9:[function(e,n){n.exports=function(n,t,o,r){function i(e){return function(){var n=m.parentNode,t=[].indexOf.call(n.childNodes,m),o=t-h+e*u.childNodes.length;n.replaceChild(s(u,r(f)(e)),n.childNodes[o])}}function c(e,n){var t,o,i=m.parentNode,c=[].indexOf.call(i.childNodes,m),l=c-h+e*u.childNodes.length,a=n*u.childNodes.length;for(t=0,o=document.createDocumentFragment();n>t;t++)o.appendChild(s(u,r(f)(e+t)));i.insertBefore(o,i.childNodes[l]),h+=a}function l(e,n){var t=m.parentNode,o=[].indexOf.call(t.childNodes,m),r=o-h+e*u.childNodes.length,i=n*u.childNodes.length;for(h-=i;i--;)t.removeChild(t.childNodes[r])}function a(){for(var e,n,t,o=r(f);h;)m.parentNode.removeChild(m.previousSibling),h--;if("function"==typeof o&&o.len){for(o.on("insert",c),o.on("delete",l),t=document.createDocumentFragment(),e=0,n=o.len;n>e;e++)o.on("change",e,i(e)),t.appendChild(s(u,o(e)));h=t.childNodes.length,m.parentNode.insertBefore(t,m)}else"function"!=typeof o||o.len?o&&(t=s(u,r),h=t.childNodes.length,m.parentNode.insertBefore(t,m)):(t=s(u,o),h=t.childNodes.length,m.parentNode.insertBefore(t,m))}var u,s=e("../compiler"),d=n.match(new RegExp("^#"+e("../consts").RE_SRC_IDENTIFIER)),f=d&&d[1],p=document.createDocumentFragment(),m=document.createComment(""),h=0;return d?{block:f,replace:function(e){return p.appendChild(m),u=e,r.on("change",f,a),setTimeout(a,0),m}}:void 0}},{"../compiler":3,"../consts":4}],10:[function(e,n){n.exports=function(n,t,o,r){function i(){var n=r(a);e("element-class")(t)[!!n&&"add"||"remove"](c)}var c,l=n.match(new RegExp("#"+e("../consts").RE_SRC_IDENTIFIER)),a=l&&l[1];return"class"===o&&l?(r.on("change",a,i),setTimeout(i,0),{block:a,replace:function(e){return c=e,""}}):void 0}},{"../consts":4,"element-class":1}],11:[function(e,n){n.exports=function(n,t,o,r){var i=e("../consts"),c=n.match(">"+i.RE_PARTIAL),l=document.createComment(""),a=c&&function(){return function(e){jtmpl(l.parentNode,e,r)}(c[1]?r(c[1]):c[2]||c[3])};return c?(c[1]&&r.on("change",c[1],a),setTimeout(a,0),{replace:l}):void 0}},{"../consts":4}],12:[function(e,n){n.exports=function(n,t,o,r){function i(){var e=r(l);t[o]!==e&&(t[o]=e)}var c=n.match(e("../consts").RE_IDENTIFIER),l=c&&c[0];if(c&&["value","checked","selected"].indexOf(o)>-1){r.on("change",l,i),i(),"OPTION"===t.nodeName&&setTimeout(function(){t.parentNode.addEventListener("change",function(){r(l)!==t.selected&&r(l,t.selected)})},0),"radio"===t.type&&t.name&&t.addEventListener("change",function(){if(t[o])for(var e=0,n=document.querySelectorAll("input[type=radio][name="+t.name+"]"),i=n.length;i>e;e++)n[e]!==t&&n[e].dispatchEvent(new Event("change"));r(l,t[o])});var a=["text","password"].indexOf(t.type)>-1?"input":"change";return t.addEventListener(a,function(){r(l,t[o])}),{replace:""}}}},{"../consts":4}],13:[function(e,n){n.exports=function(n,t,o,r){var i;return n.match(e("../consts").RE_IDENTIFIER)?(o?r.on("change",n,function(){var e=r(n);return e?t.setAttribute(o,e):t.removeAttribute(o)}):(i=document.createTextNode(""),r.on("change",n,function(){i.data=r(n)||""})),r(n,r(n)),{replace:i}):void 0}},{"../consts":4}],14:[function(e,n){n.exports=function(){var e,n,t,o,r,i=[].slice.call(arguments),c=new XMLHttpRequest,l=i.reduce(function(e,n){return"function"==typeof n?n:e},null),a=i[i.length-1];for("object"!=typeof a&&(a={}),e=0,o=Object.getOwnPropertyNames(a),n=o.length;n>e;e++)t=o[e],c[t]=a[t];r="string"==typeof i[2]?i[2]:"object"==typeof i[2]?Object.keys(i[2]).map(function(e){return e+"="+encodeURIComponent(i[2][e])}).join("&"):"",c.onload=function(e){var n;if(l){try{n=JSON.parse(this.responseText)}catch(e){n=this.responseText}l.call(this,n,e)}},c.open(i[0],i[1],void 0!==a.async?a.async:!0,a.user,a.password),c.send(r)}},{}]},{},[7])(7)});